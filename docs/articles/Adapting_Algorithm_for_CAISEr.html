<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adapting Algorithms for CAISEr â€¢ CAISEr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Adapting Algorithms for CAISEr">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CAISEr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Adapting_Algorithm_for_CAISEr.html">Adapting Algorithms for CAISEr</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Adapting Algorithms for CAISEr</h1>
                        <h4 class="author">Felipe Campelo</h4>
            
            <h4 class="date">2019-07-07</h4>
      
      
      <div class="hidden name"><code>Adapting_Algorithm_for_CAISEr.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This is a short guide to adapting existing algorithms and problem instances for running an experiment using CAISEr. In this document, we cover:</p>
<ul>
<li>Definition of instance lists</li>
<li>Adaptation of existing algorithms</li>
<li>Some stuff you can do with the results</li>
</ul>
<p>A general description of the CAISE methodology is available in our papers: - F. Campelo, F. Takahashi, <em>Sample size estimation for power and accuracy in the experimental comparison of algorithms</em>. Journal of Heuristics 25(2):305-338, 2019.]<br>
- F. Campelo, E. Wanner, <em>Sample size calculations for the experimental comparison of multiple algorithms on multiple problem instances</em>. Submitted, Journal of Heuristics, 2019.</p>
</div>
<div id="assembling-an-instance-list" class="section level2">
<h2 class="hasAnchor">
<a href="#assembling-an-instance-list" class="anchor"></a>Assembling an instance list</h2>
<p>As stated in the documentation of both <code><a href="../reference/run_experiment.html">run_experiment()</a></code> and <code><a href="../reference/calc_nreps.html">calc_nreps()</a></code>, each instance must be a named list containing all relevant parameters that define the problem instance. This list must contain at least the field <code>instance$FUN</code>, with the name of the problem instance function, that is, a routine that calculates <span class="math inline">\(y = f(x)\)</span>. If the instance requires additional parameters, these must also be provided as named fields. Each instance can also have an <code>alias</code>, a unique name to distinguish it from other instances. If no alias is provided, the name of the function (<code>instance$FUN</code>) is used as the instance ID.</p>
<p>The <code>instances</code> parameter for <code><a href="../reference/run_experiment.html">run_experiment()</a></code> is simply a list or vector of these instance lists.</p>
<p>To illustrate how to adapt existing implementations to this structure, we assume that we are interested in comparing four multiobjective optimization algorithms for a (hypothetical) problem class represented by problems UF1 - UF7 (in dimensions between 10 and 40) from package <a href="https://CRAN.R-project.org/package=smoof">smoof</a>. For this implementation to work with the <code><a href="https://www.rdocumentation.org/packages/MOEADr/topics/moead">MOEADr::moead()</a></code> routine (see next section) some manipulation is necessary, but the instance list in this case is simply a list with each element containing the name of the routine as field <code>$FUN</code> (since all function names are different, no need for aliases).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(smoof))
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(MOEADr))
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(CAISEr))

### Build function names (instances: UF1 - UF7, dimensions 10 - 40)
fname   &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"UF_"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)
dims    &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">10</span><span class="op">:</span><span class="dv">40</span>)
allfuns &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expand.grid">expand.grid</a></span>(fname, dims, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)

<span class="co"># Assemble instances list</span>
instances &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">vector</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(allfuns), <span class="dt">mode =</span> <span class="st">"list"</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(instances)){
  instances[[i]]<span class="op">$</span>FUN &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(allfuns[i,<span class="dv">1</span>], <span class="st">"_"</span>, allfuns[i,<span class="dv">2</span>])
}

### Build the functions listed above (so that they can be properly used)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(allfuns)){
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="dt">x =</span> instances[[i]]<span class="op">$</span>FUN,
     <span class="dt">value =</span> MOEADr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/MOEADr/topics/make_vectorized_smoof">make_vectorized_smoof</a></span>(<span class="dt">prob.name  =</span> <span class="st">"UF"</span>,
                    <span class="dt">dimensions =</span> allfuns[i, <span class="dv">2</span>],
                    <span class="dt">id =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/strsplit">strsplit</a></span>(allfuns[i, <span class="dv">1</span>], <span class="st">"_"</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])))
}</code></pre></div>
</div>
<div id="adaptation-of-an-existing-algorithm-implementation" class="section level2">
<h2 class="hasAnchor">
<a href="#adaptation-of-an-existing-algorithm-implementation" class="anchor"></a>Adaptation of an existing algorithm implementation</h2>
<p>We will use the MOEA/D implementation available in the <a href="https://CRAN.R-project.org/package=MOEADr">MOEADr</a> package as our base algorithm, and assume that we are interested in comparing the performance of four versions of this algorithm: the two versions described in the <a href="https://ieeexplore.ieee.org/document/4358754">original MOEA/D paper</a>, the one described in the <a href="https://ieeexplore.ieee.org/document/4633340">MOEA/D-DE paper</a>, and a variation of the MOEA/D-DE configuration that uses PBI as the aggregation function and calculates neighborhoods based on the space of parameters instead of on the scalarisation weight vectors (see the documentation of <a href="https://CRAN.R-project.org/package=MOEADr">MOEADr</a> and references therein for details of these methods) as solvers of the hypothetical problem class represented by the available test instances. The performance of each algorithm on each instance will be measured according to an indicator known as <em>Inverted Generational Distance</em> (IGD - details <a href="http://ieeexplore.ieee.org/document/1197687/">here</a>), for which <em>smaller = better</em>.</p>
<p>As described in the documentation of both <code><a href="../reference/run_experiment.html">run_experiment()</a></code> and <code><a href="../reference/calc_nreps.html">calc_nreps()</a></code>, an <code>algorithm</code> must contain an <code>algorithm$FUN</code> field (the name of the function that calls the algorithm) and any other elements/parameters that <code>algorithm$FUN</code> requires (e.g., stop criteria, operator names and parameters, etc.). An additional field, <code>algorithm$alias</code>, can be used to provide the algorithm with a unique identifier.</p>
<p>Supposing that the list in <code>algorithm</code> has fields <code>algorithm$FUN = myalgo</code>, <code>algorithm$par1 = "a"</code>, <code>algorithm$par2 = 5</code>, then the function in <code>algorithm$FUN</code> must have the following structure:</p>
<pre><code>myalgo &lt;- function(par1, par2, instance, ...){
  # do stuff
  return(results)
}</code></pre>
<p>That is, it must be able to run if called as:</p>
<pre><code># remove '$FUN' and '$alias' field from list of arguments
# and include the problem definition as field 'instance'
myargs          &lt;- algorithm[names(algorithm) != "FUN"]
myargs          &lt;- myargs[names(myargs) != "alias"]
myargs$instance &lt;- instance

# call 'algorithm$FUN' with the arguments in 'myargs'
do.call(algorithm$FUN, args = myargs)</code></pre>
<p>Finally, the <code>algorithm$FUN</code> routine must return a list object containing (at least) the performance value of the final solution obtained after a given run, in a field named <code>value</code> (e.g., <code>result$value</code>) .</p>
<p>To build the algorithm functions to be used in <code><a href="../reference/run_experiment.html">run_experiment()</a></code>, we encapsulate (almost) all algorithm parameters within a <code>myalgo()</code> function, which receives only two inputs: the instance to be solved (i.e., one element from <code>Instance.list</code>) and the specification of which version of the algorithm is to be run.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Prepare algorithm function to be used in run_experiment():</span>
myalgo &lt;-<span class="st"> </span><span class="cf">function</span>(type, instance){
  <span class="co"># Input parameters:</span>
  <span class="co">#     - type (variant to use: "original", "original2", "moead.de" or "moead.de2")</span>
  <span class="co">#     - instance (instance to be solved, e.g., instance = instances[[i]])</span>
  <span class="co"># All other parameters are set internally</span>

  ## Extract instance information to build the MOEADr problem format
  fdef  &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/strsplit">strsplit</a></span>(instance<span class="op">$</span>FUN, <span class="dt">split =</span> <span class="st">"_"</span>))
  uffun &lt;-<span class="st"> </span>smoof<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/smoof/topics/makeUFFunction">makeUFFunction</a></span>(<span class="dt">dimensions =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(fdef[<span class="dv">3</span>]),
                                 <span class="dt">id         =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(fdef[<span class="dv">2</span>]))
  fattr    &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attr">attr</a></span>(uffun, <span class="st">"par.set"</span>)
  prob.dim &lt;-<span class="st"> </span>fattr<span class="op">$</span>pars<span class="op">$</span>x<span class="op">$</span>len
  
  ## Build MOEADr problem list
  problem &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">name =</span> instance<span class="op">$</span>FUN,
                  <span class="dt">xmin =</span> fattr<span class="op">$</span>pars<span class="op">$</span>x<span class="op">$</span>lower,
                  <span class="dt">xmax =</span> fattr<span class="op">$</span>pars<span class="op">$</span>x<span class="op">$</span>upper,
                  <span class="dt">m    =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attr">attr</a></span>(uffun, <span class="st">"n.objectives"</span>))

  ## Load presets for the algorithm provided in input 'type' and 
  ## modify whatever is needed for this particular experiment
  de2 &lt;-<span class="st"> </span><span class="ot">FALSE</span>
  <span class="cf">if</span> (type <span class="op">==</span><span class="st"> "moead.de2"</span>){
    de2  &lt;-<span class="st"> </span><span class="ot">TRUE</span>
    type &lt;-<span class="st"> "moead.de"</span>
  }
  algo.preset &lt;-<span class="st"> </span>MOEADr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/MOEADr/topics/preset_moead">preset_moead</a></span>(type)
  algo.preset<span class="op">$</span>decomp<span class="op">$</span>H &lt;-<span class="st"> </span><span class="dv">99</span> <span class="co"># &lt;-- set population size</span>
  algo.preset<span class="op">$</span>stopcrit[[<span class="dv">1</span>]]<span class="op">$</span>name &lt;-<span class="st"> "maxeval"</span> <span class="co"># &lt;-- type of stop criterion</span>
  algo.preset<span class="op">$</span>stopcrit[[<span class="dv">1</span>]]<span class="op">$</span>maxeval &lt;-<span class="st"> </span><span class="dv">2000</span> <span class="op">*</span><span class="st"> </span>prob.dim <span class="co"># stop crit.</span>
  poly.ind &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(algo.preset<span class="op">$</span>variation,
                           <span class="cf">function</span>(x){x<span class="op">$</span>name <span class="op">==</span><span class="st"> "polymut"</span>}))
  algo.preset<span class="op">$</span>variation[[poly.ind]]<span class="op">$</span>pm &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>prob.dim <span class="co"># &lt;--- pm = 1/d</span>
  <span class="cf">if</span> (de2){
    algo.preset<span class="op">$</span>aggfun<span class="op">$</span>name &lt;-<span class="st"> "pbi"</span>
    algo.preset<span class="op">$</span>aggfun<span class="op">$</span>theta &lt;-<span class="st"> </span><span class="dv">5</span>
    algo.preset<span class="op">$</span>neighbors<span class="op">$</span>name =<span class="st"> "x"</span>
  }
  
  ## Run algorithm on "instance"
  out &lt;-<span class="st"> </span>MOEADr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/MOEADr/topics/moead">moead</a></span>(<span class="dt">preset =</span> algo.preset, <span class="dt">problem =</span> problem,
                       <span class="dt">showpars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">show.iters =</span> <span class="st">"none"</span>))

  ## Read reference data to calculate the IGD
  Yref  &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">as.matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/read.table">read.table</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"./inst/extdata/pf_data/"</span>,
                                       fdef[<span class="dv">1</span>], fdef[<span class="dv">2</span>], <span class="st">".dat"</span>)))
  IGD =<span class="st"> </span>MOEADr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/MOEADr/topics/calcIGD">calcIGD</a></span>(<span class="dt">Y =</span> out<span class="op">$</span>Y, <span class="dt">Yref =</span> Yref)

  ## Return IGD as field "value" in the output list
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">value =</span> IGD))
}</code></pre></div>
<p>Finally, the <code>algorithms</code> parameter must be assembled as a list of algorithm objects (each containing fields <code>$FUN</code>, <code>$alias</code> and, in this case, <code>$type</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Assemble Algorithm.list. Notice that we need to provide an alias for each </span>
<span class="co"># method, since both algorithms have the same '$FUN' argument.</span>
algorithms &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">FUN   =</span> <span class="st">"myalgo"</span>, 
                        <span class="dt">alias =</span> <span class="st">"Original 1"</span>, 
                        <span class="dt">type  =</span> <span class="st">"original"</span>),
                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">FUN   =</span> <span class="st">"myalgo"</span>, 
                        <span class="dt">alias =</span> <span class="st">"Original 2"</span>, 
                        <span class="dt">type  =</span> <span class="st">"original2"</span>),
                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">FUN   =</span> <span class="st">"myalgo"</span>, 
                        <span class="dt">alias =</span> <span class="st">"MOEAD-DE"</span>, 
                        <span class="dt">type  =</span> <span class="st">"moead.de"</span>),
                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">FUN   =</span> <span class="st">"myalgo"</span>, 
                        <span class="dt">alias =</span> <span class="st">"MOEAD-DE2"</span>, 
                        <span class="dt">type  =</span> <span class="st">"moead.de2"</span>))</code></pre></div>
</div>
<div id="running-an-experiment-using-caiser" class="section level2">
<h2 class="hasAnchor">
<a href="#running-an-experiment-using-caiser" class="anchor"></a>Running an experiment using CAISEr</h2>
<p>With the definitions above it is possible now to run an experiment using the iterative sample size determination implemented in CAISEr. For that, all we have to do is define the desired experimental parameters and use <code><a href="../reference/run_experiment.html">run_experiment()</a></code>. <strong>IMPORTANT NOTICE:</strong> running this experiment takes a while (about 4 hours in a 3.6 GHz Intel Core i7 iMac with 16Gb RAM, using 7 cores).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.results &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_experiment.html">run_experiment</a></span>(<span class="dt">instances  =</span> instances,
                             <span class="dt">algorithms =</span> algorithms,
                             <span class="dt">power =</span> <span class="fl">0.8</span>,      <span class="co"># Desired power: 80%</span>
                             <span class="dt">power.target =</span> <span class="st">"mean"</span>, <span class="co"># on average,</span>
                             <span class="dt">d =</span> <span class="fl">0.5</span>,          <span class="co"># to detect differences greater</span>
                                               <span class="co"># than 0.5 standard deviations</span>
                             <span class="dt">sig.level =</span> <span class="fl">0.05</span>, <span class="co"># at a 95% confidence level. </span>
                             <span class="dt">se.max =</span> <span class="fl">0.05</span>,    <span class="co"># Measurement error: 5% </span>
                             <span class="dt">dif =</span> <span class="st">"perc"</span>,     <span class="co"># on the paired percent </span>
                                               <span class="co"># differences of means,</span>
                             <span class="dt">method =</span> <span class="st">"param"</span>, <span class="co"># calculated using parametric</span>
                                               <span class="co"># formula.</span>
                             <span class="dt">comparisons =</span> <span class="st">"all.vs.all"</span>, <span class="co"># Compare all algorithms </span>
                                                         <span class="co"># vs all others,</span>
                             <span class="dt">nstart =</span> <span class="dv">15</span>,      <span class="co"># start with 15 runs/algo/inst</span>
                             <span class="dt">nmax   =</span> <span class="dv">200</span>,     <span class="co"># and do no more than 200 runs/inst.</span>
                             <span class="dt">seed   =</span> <span class="dv">1234</span>,    <span class="co"># PRNG seed (for reproducibility)</span>
                             <span class="co">#</span>
                             <span class="co"># </span><span class="al">NOTICE</span><span class="co">: Using all but 1 cores. Change if needed</span>
                             <span class="dt">ncpus  =</span> parallel<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/parallel/topics/detectCores">detectCores</a></span>() <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<p>After that we can interrogate the results and perform inference, if we are so inclined. For instance, we can check if all paired differences in performance are (at least approximately) Normal, so that we can assume a Normal sampling distribution of the means and use t-tests without much worry:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(car))

algopairs &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(my.results<span class="op">$</span>data.summary<span class="op">$</span>Alg1, 
                   my.results<span class="op">$</span>data.summary<span class="op">$</span>Alg2,
                   <span class="dt">sep =</span> <span class="st">" - "</span>)

<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>, <span class="dv">2</span>))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq_along</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(algopairs))){
  tmp &lt;-<span class="st"> </span>my.results<span class="op">$</span>data.summary[algopairs <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(algopairs)[i], ]
  car<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/car/topics/qqPlot">qqPlot</a></span>(tmp<span class="op">$</span>Phi, 
            <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(algopairs)[i],
            <span class="dt">ylab =</span> <span class="st">"observed"</span>, <span class="dt">xlab =</span> <span class="st">"theoretical quantiles"</span>)
}</code></pre></div>
<p><img src="Adapting_Algorithm_for_CAISEr_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>))</code></pre></div>
<p>The normal QQ plots indicate some deviation from normality, with the <code>MOEA/D-DE</code> vs. <code>MOEA/D-DE2</code> comparison having a particularly longer left tail. We can check visually the effect of this in the sampling distribution of the means:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>, <span class="dv">2</span>))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq_along</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(algopairs))){
  tmp &lt;-<span class="st"> </span>my.results<span class="op">$</span>data.summary[algopairs <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(algopairs)[i], ]
  boot.means &lt;-<span class="st"> </span>CAISEr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/CAISEr/topics/boot_sdm">boot_sdm</a></span>(tmp<span class="op">$</span>Phi, <span class="dt">boot.R =</span> <span class="dv">999</span>)
  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/hist">hist</a></span>(boot.means, <span class="dt">breaks =</span> <span class="dv">30</span>, <span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(algopairs)[i], <span class="dt">las =</span> <span class="dv">1</span>)
}</code></pre></div>
<p><img src="Adapting_Algorithm_for_CAISEr_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>))</code></pre></div>
<p>The deviations does not seem to be too severe, but are enough to justify using a nonparametric alternative (e.g., Wilcoxonâ€™s Rank-Sum tests) instead of the t-test. This will sacrifice a little power for borderline cases (i.e., comparisons where the actual effect size is close to the value of <span class="math inline">\(d^*\)</span> used in the design of the experiment), but give us more confidence in the comparisons that end up being statistically significant.</p>
<p>Some other graphical analysis can be quite informative:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Comparison =</span> algopairs, my.results<span class="op">$</span>data.summary)

<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2))
mp &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(df, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> Comparison, <span class="dt">y =</span> Phi, <span class="dt">fill =</span> Comparison))
mp <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span>(<span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="st">"width"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>(<span class="dt">alpha =</span> <span class="dv">0</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>, 
               <span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">width =</span> .<span class="dv">15</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">shape =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">"black"</span>, <span class="dt">fill =</span> <span class="st">"black"</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>,
             <span class="dt">position =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span>(<span class="dt">width =</span> .<span class="dv">15</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span>(<span class="dt">slope =</span> <span class="dv">0</span>, <span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Percent difference in IGD"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">""</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.text.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="Adapting_Algorithm_for_CAISEr_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Recall first that <code>smaller = better</code> for the quality indicator used in this experiment. Looking at the plot above shows that the differences between all pairs of algorithms were quite high - e.g., differences of up to 200% in the case of the <code>Original 2</code> versus both MOEA/D-DE versions. In general both <code>MOEA/D-DE</code> versions seem to generate better (lower) IGD values than the <code>Original</code> versions, and <code>MOEA/D-DE</code> seems generally better than <code>MOEA/D-DE2</code> (first comparison to the left. Also, the variability seem to be reasonably high for all comparisons.</p>
<p>We can also visualise the individual estimates (with their standard errors):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mp &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(df, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> Instance, <span class="dt">y =</span> Phi, <span class="dt">colour =</span> Comparison,
                     <span class="dt">ymin =</span> Phi <span class="op">-</span><span class="st"> </span>SE, <span class="dt">ymax =</span> Phi <span class="op">+</span><span class="st"> </span>SE))
mp <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_pointrange</a></span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span>(<span class="dt">slope =</span> <span class="dv">0</span>, <span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(Comparison <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.text.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">angle =</span> <span class="dv">60</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">""</span>)</code></pre></div>
<p><img src="Adapting_Algorithm_for_CAISEr_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Notice that the standard errors of the estimators are in most cases smaller than the marker used for the point estimate. Also notice that the observations fall, for each comparison, mainly on one side of the zero-line, which is an almost sure indicator that the comparisons will be statistically significant.</p>
<p>Finally, we can examine our hypothesis tests. The <code>summary</code> method of class <code>CAISEr</code> already outputs the desired information:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(my.results, <span class="dt">test =</span> <span class="st">"wilcoxon"</span>)</code></pre></div>
<pre><code>## #====================================
##  CAISEr object:
##  Number of instances sampled: 46
##  Number of instances required: 46
##  Adequate power: TRUE
##  Total runs of Original 1 : 1281
##  Total runs of Original 2 : 1472
##  Total runs of MOEAD-DE : 2020
##  Total runs of MOEAD-DE2 : 3317
## #====================================
##  Pairwise comparisons of interest:
##  Test: wilcoxon
##  H1: two.sided
##  Comparisons: all.vs.all
##  Alpha (FWER): 0.05
##  Power target: mean
##  Desired power: 0.8
## #====================================
## Tests using Holm's step-down procedure:
## 
##  Test 1 : Original 1 - Original 2
##  H0: median = 0
##  alpha       = 0.008333 
##  p-value = 2.842e-14
##  Est. median = -0.4038
##  CI{1-alpha} = [ -0.5658 -0.2688 ]
##  d       = -1.310538
## 
##  Test 2 : MOEAD-DE - MOEAD-DE2
##  H0: median = 0
##  alpha       = 0.01 
##  p-value = 8.527e-14
##  Est. median = -0.1487
##  CI{1-alpha} = [ -0.2879 -0.111 ]
##  d       = -0.9829994
## 
##  Test 3 : Original 2 - MOEAD-DE
##  H0: median = 0
##  alpha       = 0.0125 
##  p-value = 4.791e-10
##  Est. median = 1.033
##  CI{1-alpha} = [ 0.7269 1.47 ]
##  d       = 1.270841
## 
##  Test 4 : Original 1 - MOEAD-DE
##  H0: median = 0
##  alpha       = 0.01667 
##  p-value = 9.02e-06
##  Est. median = 0.5934
##  CI{1-alpha} = [ 0.2504 0.8769 ]
##  d       = 0.7954248
## 
##  Test 5 : Original 2 - MOEAD-DE2
##  H0: median = 0
##  alpha       = 0.025 
##  p-value = 1.396e-05
##  Est. median = 0.7765
##  CI{1-alpha} = [ 0.5863 1.194 ]
##  d       = 0.9214111
## 
##  Test 6 : Original 1 - MOEAD-DE2
##  H0: median = 0
##  alpha       = 0.05 
##  p-value = 0.01257
##  Est. median = 0.4054
##  CI{1-alpha} = [ 0.1109 0.6285 ]
##  d       = 0.4501527
## #====================================</code></pre>
<p>All differences were found to be different at the <span class="math inline">\(95\%\)</span> joint significance level.</p>
<p>Finally, the full data of the experiment is contained in other fields of the output list <code>my.results</code>, and the user is encouraged to explore these. It is possible, for instance, to can generate box plots and confidence intervals on the mean performance of each algorithm on each sampled instance, which can inspire new questions for the researcher.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#assembling-an-instance-list">Assembling an instance list</a></li>
      <li><a href="#adaptation-of-an-existing-algorithm-implementation">Adaptation of an existing algorithm implementation</a></li>
      <li><a href="#running-an-experiment-using-caiser">Running an experiment using CAISEr</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Felipe Campelo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
